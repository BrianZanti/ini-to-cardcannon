[epic-merchant-dashboard]
title = Epic: Merchant Dashboard
labels: inbox, merchant, dashboard
story_text: ## Merchant Dashboard
    This is the landing page when a merchant logs in. Here, they will see their contact information (but cannot change it), some statistics, and a list of pending orders that require the merchant's attention.
    NEWLINE
    ### Admins can act on behalf of merchants
    Admin users will see more information on the "/merchants" route that all users see. For example, on this page, an admin user can navigate to each merchant's dashboard under a route like "/admin/merchants/7". This will allow the admin to perform every action that the merchant themselves can perform. Admin users can also "downgrade" a merchant account to become a user account.


[merchant-dashboard-show-page]
title: Merchant Dashboard Show Page
labels: merchant, dashboard
child_of: epic-merchant-dashboard
depends_on: user-registration, merchant-navigation
story_text: As a merchant user
    When I visit my merchant dashboard ("/merchant")
    I see my profile data, but cannot edit it


[merchant-dashboard-shows-orders]
title: Merchant Dashboard displays Orders
labels: merchant, dashboard, orders
child_of: epic-merchant-dashboard
depends_on: merchant-dashboard-show-page
story_text: As a merchant
    When I visit my merchant dashboard ("/merchant")
    If any users have pending orders containing items I sell
    Then I see a list of these orders.
    Each order listed includes the following information:
    - the ID of the order, which is a link to the order show page ("/merchant/orders/15")
    - the date the order was made
    - the total quantity of my items in the order
    - the total value of my items for that order


[merchant-items-index-page]
title: Merchant's Items index page
labels: merchant, items
child_of: epic-merchant-dashboard
depends_on: user-profile-show-page
story_text: As a merchant
    When I visit my merchant dashboard
    I see a link to view my own items
    When I click that link
    My URI route should be "/merchant/items"

[merchant-users-index]
title: Merchant Sees Their Users
labels: merchant
child_of: epic-merchant-dashboardstory_text: As a Merchant User
    When I visit my dashboard
    I see a link to see 'Merchant Users'
    When I click this link
    I am taken to my merchants users page
    And I see all users assigned to my Merchant
    For each user I see:
      - Name
      - Email
      - A link to remove that user from this merchant

[merchant-removes-user]
title: Merchant Removes User
labels: merchant
child_of: epic-merchant-dashboarddepends_on: merchant-users-index
story_text: As a Merchant User
    When I visit my merchant's users page
    I see a link or button to remove a user from the merchant
    When I click that link or button
    I am returned to my merchant's users page
    And I no longer see that user
    NEWLINE
    Now, when the user that I removed attempts to log in, they will be logged in as a regular.

[merchant-adds-user]
title: Merchant Adds User
labels: merchant
child_of: epic-merchant-dashboarddepends_on: merchant-users-index
story_text: As a Merchant User
  When I visit my merchant's users page
  I see a form to add a new user to the merchant
  Then I fill in the form with an existing user's email address
  And click 'Add User to Merchant'
  Then I am redirected back to my merchant's users page
  And I see that user listed along with the other merchant users for my merchant.
  NEWLINE
  I can only add a user who exists, is not an admin user, and is not assigned to a merchant.
  Now, when the user that I added logs in, they will be logged in as a merchant user.

[merchant-items-placeholder-image-notification]
title: Merchant Sees Items that Need Images
labels: merchant, item
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my dashboard
    I see an area listing all items that are using a placeholder image
    Each item name is a link to that item's edit page
    When I click on that link
    And update the item with an image
    I am returned to my Items index
    When I next visit my dashboard, that item is no longer listed as needing an image

[merchant-unfulfilled-revenue]
title: Merchant Sees Unfulfilled Revenue
labels: merchant, item
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my dashboard
    I see statistics showing:
      - How many orders are unfulfilled
      - How much revenue those unfulfilled orders would generate for my merchant

[merchant-sees-unfulfillable-orders]
title: Merchant Sees Unfulfillable Orders
labels: merchant, item, order
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my dashboard
    In my list of orders
    I see a warning message (Inventory Conflict) next to any order that has an order_item quantity that exceeds my available inventory for that item

[merchant-sees-unfulfillable-order-combos]
title: Merchant Sees Unfulfillable Order Combinations
labels: merchant, item, order
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my dashboard
    In my list of orders
    If an item has been ordered more than once, and the sum of those order_item quantities exceed the available item inventory
    I see a warning next to all affected orders indicating 'Multiple Order Conflict'

[merchant-adds-bulk-discount]
title: Merchant Can Add a Bulk Discount
labels: merchant, bulk_discount
child_of: epic-merchant-dashboard
depends_on: merchant-bulk-discount-index
story_text: As a Merchant User
    When I visit my merchant's discount index
    I see a link or button to Add a Bulk Discount
    When I click that link or button
    I am taken to a new bulk-discount form where I enter the following information:
      - name
      - amount of the bulk-discount in dollars/cents (ex: .5 means the bulk-discount is for $0.05 off an item's price)
      - quantity needed to activate the bulk discount
    When I click "Create Discount"
    I am redirected back to my merchant's discount index

[merchant-bulk-discount-index]
title: Merchant sees all bulk discounts
labels: merchant, bulk_discount
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my dashboard
    I see a link or button labeled 'Discounts'
    When I click that link or button
    I am taken to a page where I can see all my merchant's existing discounts
    For each discount, I see:
      - Name
      - Amount
      - Quantity Needed to activate the discount
      - Link or button to edit the discount
      - Link or button do delete the discount

[merchant-edits-bulk-discount]
title: Merchant Edits Discount
labels: merchant, bulk_discount
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my merchant's discounts page
    And click 'Edit' next to a discount
    I am taken to a form to edit the discount (the form prepopulates with the current discount information)
    On that form, I can edit the:
      - Name
      - Amount
      - Quantity Needed
    When I click 'Update Discount'
    I am returned to my merchant's discounts page
    And I see the updated information
    NEWLINE
    Updating a discount does not change any existing order_item prices

[merchant-deletes-bulk-discount]
title: Merchant Deletes Discount
labels: merchant, bulk_discount
child_of: epic-merchant-dashboard
story_text: As a Merchant User
    When I visit my merchant's discounts page
    And click 'Delete' next to a discount
    The discount is deleted and I am returned to the merchant's discounts page
    NEWLINE
    Deleting a discount does not change any existing order_item prices


[admin-merchant-dashboard]
title: Admin can see a merchant's dashboard
labels: admin, merchant, dashboard
child_of: epic-merchant-dashboard
story_text: As an admin user
    When I visit the merchant index page ("/merchants")
    And I click on a merchant's name,
    Then my URI route should be ("/admin/merchants/6")
    Then I see everything that merchant would see
